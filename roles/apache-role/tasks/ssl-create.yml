---

  - name: Create an Open SSL Cert
    openssl_certificate:
      path: /etc/ssl/csr/www.hello.com.crt
      privatekey_path: /etc/ssl/private/hello.com.pem
      csr_path: /etc/ssl/csr/hello.com.csr
      provider: selfsigned

  - name: make sure SSL certificate is existing and secured
    file:
      state:  file
      path:   '{{ item.path }}'
      owner:  root
      group:  root
      mode:   '{{ item.mode }}'
    with_items:
      - path: /etc/ssl/csr/www.hello.com.csr
        mode: '0644'
      - path: /etc/ssl/private/hello.com.pem
        mode: '0600'

  - name: make sure SSL certificate is existing and secured
    copy:
      src:    '{{ item.src }}'
      path:   '{{ item.path }}'
      owner:  root
      group:  root
      mode:   '{{ item.mode }}'
    no_log: true
    with_items:
      - src:  '{{ ssl_certificate }}'
        path: /path/to/my/cert.pem
        mode: '0644'
      - src:  '{{ ssl_private_key }}'
        path: /path/to/my/key.pem
        mode: '0600'

  - name: Install SSL certificate
    copy:
      content: '{{ ssl_certificate }}'
      dest: /path/to/my/cert.pem
      owner: root
      group: root
      mode: 0644
  
  - name: make sure SSL private key is installed
    copy:
      content: '{{ ssl_private_key }}'
      dest: /path/to/my/key.pem
      owner: root
      group: root
      mode: 0600
    no_log: true